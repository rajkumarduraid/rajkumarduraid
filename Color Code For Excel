import pandas as pd
from pptx import Presentation
from pptx.util import Inches
from pptx.enum.shapes import MSO_SHAPE

def create_simple_hierarchy():
    # Read Excel file
    df = pd.read_excel('employees.xlsx')
    
    # Create PowerPoint
    prs = Presentation()
    slide = prs.slides.add_slide(prs.slide_layouts[5])  # Blank slide
    
    # Position settings
    x_start = Inches(1)
    y_start = Inches(1)
    box_width = Inches(2)
    box_height = Inches(1)
    vertical_gap = Inches(1.5)
    horizontal_gap = Inches(3)
    
    # Track positions
    levels = {}
    
    # Create boxes
    for _, row in df.iterrows():
        manager = row['Manager Name']
        employee = row['Reporting Name']
        
        # Create employee box
        if employee not in levels:
            levels[employee] = len(levels) + 1
        y = y_start + (levels[employee] * vertical_gap)
        add_box(slide, employee, x_start + (levels[employee] * horizontal_gap), y, box_width, box_height)
        
        # Create manager box if needed
        if manager not in levels:
            levels[manager] = 0
            add_box(slide, manager, x_start, y_start, box_width, box_height)
        
        # Connect boxes
        connect_boxes(slide, manager, employee, levels, x_start, y_start, horizontal_gap, vertical_gap, box_width, box_height)
    
    prs.save('simple_hierarchy.pptx')
    print("PPT created successfully!")

def add_box(slide, text, x, y, width, height):
    shape = slide.shapes.add_shape(
        MSO_SHAPE.RECTANGLE,
        x, y, width, height
    )
    shape.text = text
    shape.fill.solid()
    shape.fill.fore_color.rgb = (79, 129, 189)  # Blue color
    shape.line.color.rgb = (0, 0, 0)  # Black border

def connect_boxes(slide, manager, employee, levels, x_start, y_start, h_gap, v_gap, width, height):
    # Calculate positions
    manager_x = x_start + (levels[manager] * h_gap)
    manager_y = y_start + (levels[manager] * v_gap)
    employee_x = x